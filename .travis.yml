os: linux
dist: trusty
language: java
jdk:
- openjdk8
if: |
  (branch IN (master, dev) AND commit_message !~ /^(bumped version to|release:) (\d+(\.\d+){2})(-.+)?$/) \
  OR tag =~ /^(\d+(\.\d+){2})([-+][\w\-\.+]+)?$/
git:
  depth: false
env:
  global:
    secure: J4kvyPq8BJg05x864lLOYHjcCQqHsO10t/4nq1odYrZ6udFxRKkmBUccp8P52kWAZswJXFAWHoM04Cl6nygSd/j4uzfH2Z3z0izxcfKM5MtL/1aHEmzlGuS8K5CFaRis6Oq/f04pX3rIZJu1yr5TIiI0Xbq9SqXYxGMSHqYSss2WMgJRzNQteHEefWAmZb6ivMYkR8fPs9Ad0dtFug3gOgO52jtfaSj3m6xJc0OL0Gx1EsaS/Po8DWcRtYGfvWU1BHwFR35LK8odLlt7ywJgMP1vdRz+BMxZ3PK8JLWeaYF4Pe/+L4w/iZxmz6VvUKrXyVBNRqhuA5OTuSa/cSTYsmzND5hX9GLgW8s0tiMfme/Cx+/JP2+RVnlGqyB5risGJDmnFvE/L3bCEacl87zY/506FwSmxRT3VGu6sMLBGm+3CIy6PU1SsaWOnTi9o0TX1y/VVvdlp5eWbmUb15NdFHPmfaO6MSz29fcbVNaI8pVRMdRtXEmOiJF3joOiJvLRR0WPucGG/LewhnpJIfLNKPBc2tTK2i+maCP6zHnJbOG76K1x0Exa9CWe8dp2LHRV/K0yiolxx8XKqQIAwbGVBxQdN9/qAqX32uupeWTxW5oGOcwMAMjvrV9TSxnSzKjaPK/7ttyOt4G4pSQUCJODHGbYKoeDbmp/wCQRBNwgOpo=
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
  directories:
  - ".autoconf"
  - "$HOME/.m2"
  - "$HOME/.gradle/caches/modules-2/"
  - "$HOME/.gradle/wrapper/dists/"
before_install:
- openssl aes-256-cbc -K $encrypted_2afbb999f001_key -iv $encrypted_2afbb999f001_iv
  -in gradle.properties.enc -out gradle.properties -d
- openssl aes-256-cbc -K $encrypted_70811ee8b6a1_key -iv $encrypted_70811ee8b6a1_iv
  -in .travis/secret.gpg.enc -out .travis/secret.gpg -d
- git config --global user.name "Travis CI"
- git config --global user.email "travis.ci@yi.team"
- chmod +x ./gradlew .travis/*.sh
- ls -lh
- git log --graph --full-history --all --color --date=short --pretty=format:"%Cred%x09%h
  %Creset%ad%Cgreen%d %Creset %s %C(bold)(%an)%Creset" || true
install: "/bin/true"
script:
- "./gradlew clean"
deploy:
- provider: script
  skip_cleanup: true
  cleanup: false
  script: ".travis/deploy-snapshot.sh"
  on:
    branch: master
- provider: script
  skip_cleanup: true
  cleanup: false
  script: ".travis/deploy-release.sh"
  on:
    tags: true
